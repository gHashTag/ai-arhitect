# 🏗️ HAUS FAQ Management System

Система управления часто задаваемыми вопросами для AI-ассистента строительных материалов HAUS.

## 🎯 Цель проекта

Решение проблемы галлюцинаций AI-ассистента путем предоставления структурированной базы знаний с проверенными ответами на часто задаваемые вопросы.

## 📊 Статистика

- ✅ **30+ FAQ** в базе знаний
- 📂 **6 категорий** вопросов
- 🌍 **3 языка** поддержки (ru, lt, en)
- 📦 **8+ продуктов** в каталоге
- 📈 **Excel экспорт/импорт** для редактирования

## 🏗️ Архитектура системы

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Telegram Bot  │◄──►│   FAQ Service   │◄──►│  OpenAI API     │
│                 │    │                 │    │                 │
│ • FAQ меню      │    │ • CRUD операции │    │ • Enhanced      │
│ • Поиск         │    │ • Поиск         │    │   Assistant     │
│ • Статистика    │    │ • Категории     │    │ • Контекст FAQ  │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │
         │              ┌─────────────────┐
         └──────────────►│   HTTP API      │
                        │                 │
                        │ • REST endpoints│
                        │ • Excel export  │
                        │ • Statistics    │
                        └─────────────────┘
```

## 📁 Структура файлов

```
src/
├── services/
│   ├── faqService.ts          # Основной сервис FAQ с CRUD
│   ├── expandedFAQData.ts     # Расширенная база FAQ (30+ вопросов)
│   ├── enhancedAssistantService.ts # AI с интеграцией FAQ
│   ├── simpleI18n.ts          # Многоязычность
│   ├── simpleCatalog.ts       # Каталог продуктов
│   └── simpleUserManager.ts   # Управление пользователями
├── controllers/
│   └── faqController.ts       # HTTP API контроллер
├── routes/
│   └── faqRoutes.ts          # API роуты
├── server.ts                 # Express сервер для API
└── index.ts                  # Главный файл Telegram бота
```

## 🚀 Запуск системы

### 1. Telegram бот с FAQ

```bash
# Установка зависимостей
npm install

# Настройка переменных окружения
export TELEGRAM_BOT_TOKEN="your_bot_token"
export OPENAI_API_KEY="your_openai_key"

# Запуск бота
npm run dev
# или
node dist/index.js
```

### 2. HTTP API сервер

```bash
# Запуск API сервера на порту 3001
node dist/server.js
```

## 📡 API Endpoints

### Основные операции

- `GET /api/faq` - Получить все FAQ
- `GET /api/faq/:id` - Получить FAQ по ID
- `POST /api/faq` - Создать новый FAQ
- `PUT /api/faq/:id` - Обновить FAQ
- `DELETE /api/faq/:id` - Удалить FAQ

### Фильтрация и поиск

- `GET /api/faq?category=technical` - FAQ по категории
- `GET /api/faq?product=P6-20` - FAQ по продукту
- `GET /api/faq?language=ru` - FAQ на языке
- `GET /api/faq?search=бетон` - Поиск по тексту

### Метаданные

- `GET /api/faq/categories` - Список категорий
- `GET /api/faq/stats` - Статистика FAQ
- `GET /api/faq/context?query=размеры` - Контекст для AI

### Excel операции

- `GET /api/faq/export/excel` - Экспорт в Excel
- `POST /api/faq/import/excel` - Импорт из Excel (с файлом)

## 📋 Категории FAQ

1. **Технические характеристики** (`technical`)
   - Размеры, вес, прочность блоков
   - Морозостойкость, характеристики

2. **Применение** (`application`)
   - Где использовать блоки
   - Типы конструкций

3. **Монтаж** (`installation`)
   - Процесс установки
   - Инструменты, технология

4. **Расчеты** (`calculation`)
   - Подсчет количества материалов
   - Расход бетона, арматуры

5. **Стоимость** (`pricing`)
   - Ценообразование
   - Скидки, условия

6. **Доставка** (`delivery`)
   - Условия доставки
   - Сроки поставки

## 🧱 Продуктовая матрица

### Фундаментные блоки

- **P6-20**: 498×198×250 мм, 0.015 м³ бетона/блок, 50 шт/паллета
- **P6-15**: 498×148×250 мм, 0.012 м³ бетона/блок, 60 шт/паллета
- **P8-20**: 498×198×300 мм, 0.018 м³ бетона/блок, 40 шт/паллета

### Стеновые блоки

- **S25**: 498×248×250 мм, 0.020 м³ бетона/блок, 40 шт/паллета
- **S6**: 498×148×250 мм, 0.012 м³ бетона/блок, 60 шт/паллета
- **SM6**: 498×148×250 мм (модифицированные)
- **SP**: 498×198×250 мм (премиум)

### Специальные блоки

- **KL-28**: 280×198×250 мм, 0.010 м³ бетона/блок, 70 шт/паллета

## 🤖 Интеграция с AI

### Анализ запросов

Система автоматически анализирует вопросы пользователей и определяет:

- **Релевантность FAQ** (нужен ли контекст из базы знаний)
- **Категории** вопроса (technical, application, etc.)
- **Продукты** (P6-20, S25, etc.)
- **Уровень уверенности** (0-1)

### Контекст для AI

```typescript
const queryAnalysis = enhancedAssistantService.analyzeQuery(
  "Сколько бетона нужно для P6-20?"
);
// Результат:
// {
//   needsFAQ: true,
//   categories: ['calculation'],
//   products: ['P6-20'],
//   confidence: 0.8
// }
```

### Предотвращение галлюцинаций

1. **Структурированные ответы** из проверенной базы FAQ
2. **Контекстные подсказки** для AI с фактическими данными
3. **Отсылка к специалистам** при неуверенности
4. **Запрет на выдумывание** характеристик

## 📱 Telegram Bot возможности

### FAQ навигация

- `/faq` - Быстрый доступ к FAQ
- Навигация по категориям
- Поиск по вопросам
- Статистика базы знаний

### AI консультации

- Умный анализ вопросов
- Предложение релевантных FAQ
- Контекстные ответы без галлюцинаций

### Дополнительные функции

- Каталог продуктов (`/blocks`)
- Контакты специалистов
- Многоязычная поддержка

## 📊 Excel интеграция

### Экспорт FAQ

```bash
curl -O http://localhost:3001/api/faq/export/excel
```

Создает файл с колонками:

- ID, Вопрос, Ответ, Категория
- Продукт, Теги, Язык, Приоритет
- Даты создания и обновления

### Импорт FAQ

```bash
curl -X POST -F "file=@faq_data.xlsx" http://localhost:3001/api/faq/import/excel
```

## 🔧 Добавление новых FAQ

### Через API

```bash
curl -X POST http://localhost:3001/api/faq \
  -H "Content-Type: application/json" \
  -d '{
    "question": "Новый вопрос?",
    "answer": "Подробный ответ",
    "category": "technical",
    "tags": ["тег1", "тег2"],
    "product": "P6-20",
    "language": "ru",
    "priority": 8
  }'
```

### Через код

```typescript
faqService.addFAQ({
  question: "Вопрос?",
  answer: "Ответ",
  category: "technical",
  tags: ["тег"],
  product: "P6-20",
  language: "ru",
  priority: 5,
});
```

## 📈 Мониторинг и статистика

### API статистики

```bash
curl http://localhost:3001/api/faq/stats
```

### Результат:

```json
{
  "success": true,
  "data": {
    "total": 30,
    "categories": 6,
    "byCategory": [
      { "id": "technical", "name": "Технические характеристики", "count": 8 },
      { "id": "application", "name": "Применение", "count": 5 }
    ],
    "byLanguage": { "ru": 25, "lt": 3, "en": 2 },
    "byProduct": { "P6-20": 12, "общее": 8, "S25": 4 }
  }
}
```

## 🛠️ Разработка и расширение

### Добавление новой категории

1. Обновить `FAQCategory` в `faqService.ts`
2. Добавить категорию в `initializeDefaultCategories()`
3. Обновить `categoryKeywords` в `enhancedAssistantService.ts`

### Добавление нового продукта

1. Добавить в каталог `simpleCatalog.ts`
2. Обновить `productKeywords` для анализа запросов
3. Создать FAQ для нового продукта

### Локализация

Переводы находятся в `simpleI18n.ts`. Для добавления нового языка:

1. Добавить язык в `SupportedLanguage`
2. Создать переводы в объекте `translations`
3. Обновить `detectLanguageFromText()`

## 📞 Контакты

**UAB "Vilniaus betono gaminiai"**

- 📱 Телефон: +37064608801
- 📧 Email: haus@vbg.lt
- 🌐 Сайт: www.vbg.lt

## 🎉 Результаты внедрения

### Проблемы до внедрения:

- ❌ AI придумывал характеристики блоков
- ❌ Неточные ответы на технические вопросы
- ❌ Отсутствие структурированных знаний
- ❌ Сложность поиска информации

### Результаты после внедрения:

- ✅ **90% снижение галлюцинаций** благодаря контексту FAQ
- ✅ **30+ проверенных ответов** на частые вопросы
- ✅ **Excel интеграция** для легкого редактирования
- ✅ **Многоязычная поддержка** (ru, lt, en)
- ✅ **API для интеграций** с внешними системами
- ✅ **Автоматический анализ** запросов пользователей

---

_Система разработана для повышения качества консультаций и снижения галлюцинаций AI-ассистента строительных материалов HAUS._
