const ExcelJS = require("exceljs");

// Более полный словарь для завершения перевода
function translateRemaining(text) {
  let result = String(text).trim();

  // Полные предложения и длинные фразы для точной замены
  const fullSentences = {
    "HAUS P6-20 - это несъемная klojinys из betonasа, которая используется для создания монолитных конструкций.":
      "HAUS P6-20 - tai nenuimamas betono klojinys, naudojamas monolitinėms konstrukcijoms kurti.",
    "P8-20 имеет большую высоту (300 mm против 250 mm у P6-20) и толщину стенок, что обеспечивает большую прочность конструкции.":
      "P8-20 turi didesnį aukštį (300 mm prieš 250 mm P6-20) ir sienelių storį, kas užtikrina didesnį konstrukcijos stiprumą.",
    "Примут ли HAUS blokai в банке для получения кредита?":
      "Ar bankas priims HAUS blokus kredito gavimui?",
    "Да, принимают! У нас есть: 1) sertifikatas CE (европейский стандарт); 2) Технические условия; 3) Сертификат соответствия.":
      "Taip, priima! Turime: 1) CE sertifikatą (Europos standartą); 2) Technines specifikacijas; 3) Atitikties sertifikatą.",
    "HAUS SP - специальные blokai для перегородок и внутренних стен. Обеспечивают отличную звукоизоляцию.":
      "HAUS SP - specialūs blokai pertvaroms ir vidaus sienoms. Užtikrina puikią garso izoliaciją.",
    "SM6 имеют модифицированную конструкцию с улучшенными прочностными характеристиками по сравнению с обычными S6.":
      "SM6 turi modifikuotą konstrukciją su pagerrintomis stiprumo charakteristikomis, palyginti su įprastais S6.",
    "Koks skirtumas между blokasами P6-20 и P8-20?":
      "Koks skirtumas tarp P6-20 ir P8-20 blokų?",
    "HAUS P6-20 - это несъемная klojinys из betonasа, которая используется для создания монолитных конструкций.":
      "HAUS P6-20 - tai nenuimamas betono klojinys, naudojamas monolitinėms konstrukcijoms kurti.",
  };

  // Проверяем точные совпадения
  for (const [rus, lit] of Object.entries(fullSentences)) {
    if (result === rus) {
      return lit;
    }
  }

  // Массовые замены русских слов и конструкций
  const replacements = {
    // Русские буквы и символы
    а: "a",
    б: "b",
    в: "v",
    г: "g",
    д: "d",
    е: "e",
    ё: "e",
    ж: "ž",
    з: "z",
    и: "i",
    й: "j",
    к: "k",
    л: "l",
    м: "m",
    н: "n",
    о: "o",
    п: "p",
    р: "r",
    с: "s",
    т: "t",
    у: "u",
    ф: "f",
    х: "h",
    ц: "c",
    ч: "č",
    ш: "š",
    щ: "šč",
    ъ: "",
    ы: "y",
    ь: "",
    э: "e",
    ю: "ju",
    я: "ja",

    // Основные слова и фразы
    это: "tai",
    есть: "yra",
    будет: "bus",
    может: "gali",
    должен: "turi",
    можно: "galima",
    нужно: "reikia",
    надо: "reikia",
    такой: "toks",
    такая: "tokia",
    такие: "tokie",
    который: "kuris",
    которая: "kuri",
    которые: "kurie",
    когда: "kada",
    где: "kur",
    как: "kaip",
    что: "kas",
    кто: "kas",
    почему: "kodėl",
    зачем: "kam",
    откуда: "iš kur",
    куда: "kur",
    сколько: "kiek",
    много: "daug",
    мало: "mažai",
    больше: "daugiau",
    меньше: "mažiau",
    лучше: "geriau",
    хуже: "blogiau",
    хорошо: "gerai",
    плохо: "blogai",
    быстро: "greitai",
    медленно: "lėtai",
    легко: "lengva",
    трудно: "sunku",
    просто: "paprasta",
    сложно: "sudėtinga",
    важно: "svarbu",
    нужно: "reikia",
    можно: "galima",
    нельзя: "negalima",
    всегда: "visada",
    никогда: "niekada",
    иногда: "kartais",
    часто: "dažnai",
    редко: "retai",
    очень: "labai",
    совсем: "visiškai",
    почти: "beveik",
    только: "tik",
    уже: "jau",
    еще: "dar",
    также: "taip pat",
    тоже: "taip pat",
    или: "arba",
    либо: "arba",
    если: "jei",
    когда: "kada",
    пока: "kol",
    чтобы: "kad",
    потому: "nes",
    поэтому: "todėl",
    однако: "tačiau",
    хотя: "nors",
    несмотря: "nepaisant",
    кроме: "išskyrus",
    без: "be",
    вместо: "vietoj",
    между: "tarp",
    среди: "tarp",
    около: "apie",
    возле: "šalia",
    рядом: "šalia",
    далеко: "toli",
    близко: "arti",
    здесь: "čia",
    там: "ten",
    везде: "visur",
    нигде: "niekur",
    дома: "namuose",
    работа: "darbas",
    время: "laikas",
    день: "diena",
    ночь: "naktis",
    утром: "ryte",
    вечером: "vakare",
    сегодня: "šiandien",
    вчера: "vakar",
    завтра: "rytoj",
    год: "metai",
    месяц: "mėnuo",
    неделя: "savaitė",
    человек: "žmogus",
    люди: "žmonės",
    семья: "šeima",
    дети: "vaikai",
    ребенок: "vaikas",
    мужчина: "vyras",
    женщина: "moteris",
    друг: "draugas",
    город: "miestas",
    страна: "šalis",
    мир: "pasaulis",
    жизнь: "gyvenimas",
    смерть: "mirtis",
    любовь: "meilė",
    счастье: "laimė",
    проблема: "problema",
    решение: "sprendimas",
    вопрос: "klausimas",
    ответ: "atsakymas",
    правда: "tiesa",
    ложь: "melas",
    правильно: "teisingai",
    неправильно: "neteisingai",
    возможно: "galbūt",
    конечно: "žinoma",
    наверное: "turbūt",
    точно: "tiksliai",
    примерно: "maždaug",
    совершенно: "visiškai",
    абсолютно: "absoliučiai",
    полностью: "pilnai",
    частично: "iš dalies",
    немного: "šiek tiek",
    достаточно: "pakankamai",
    слишком: "per",
    весьма: "gana",
    довольно: "gana",
    особенно: "ypač",
    прежде: "anksčiau",
    сначала: "iš pradžių",
    потом: "paskui",
    затем: "tada",
    наконец: "pagaliau",
    сразу: "iš karto",
    медленно: "lėtai",
    внезапно: "staiga",
    постепенно: "palaipsniui",
    обычно: "paprastai",
    "как правило": "paprastai",
    "в основном": "dažniausiai",
    "главным образом": "daugiausia",
    "в частности": "ypač",
    например: "pavyzdžiui",
    "то есть": "tai yra",
    "другими словами": "kitaip tariant",
    кстати: "beje",
    "между прочим": "beje",
    "по крайней мере": "bent",
    "по меньшей мере": "bent",
    "как минимум": "mažiausiai",
    "как максимум": "daugiausiai",
    "не более": "ne daugiau",
    "не менее": "ne mažiau",
    приблизительно: "maždaug",
    около: "apie",
    свыше: "daugiau nei",
    менее: "mažiau nei",
    более: "daugiau nei",

    // Строительные и технические термины
    строительство: "statyba",
    строительства: "statybos",
    строить: "statyti",
    построить: "pastatyti",
    строят: "stato",
    строил: "statė",
    построил: "pastatė",
    construction: "statyba",
    монолитный: "monolitinis",
    монолитные: "monolitiniai",
    монолитных: "monolitinių",
    конструкция: "konstrukcija",
    конструкции: "konstrukcijos",
    конструкций: "konstrukcijų",
    структура: "struktūra",
    материал: "medžiaga",
    материалы: "medžiagos",
    прочность: "stiprumas",
    прочный: "stiprus",
    прочные: "stiprūs",
    прочности: "stiprumo",
    надежность: "patikimumas",
    надежный: "patikimas",
    надежные: "patikimi",
    качество: "kokybė",
    качества: "kokybės",
    качественный: "kokybiškas",
    качественные: "kokybiški",
    стандарт: "standartas",
    стандарты: "standartai",
    стандарта: "standarto",
    европейский: "europinis",
    европейские: "europos",
    сертификат: "sertifikatas",
    сертификаты: "sertifikatai",
    сертификата: "sertifikato",
    документ: "dokumentas",
    документы: "dokumentai",
    документов: "dokumentų",
    техническии: "techniniai",
    технические: "techniniai",
    технических: "techninių",
    условия: "sąlygos",
    требования: "reikalavimai",
    характеристики: "charakteristikos",
    параметры: "parametrai",
    размер: "dydis",
    размеры: "dydžiai",
    размера: "dydžio",
    высота: "aukštis",
    высоту: "aukštį",
    высоты: "aukščio",
    ширина: "plotis",
    ширину: "plotį",
    ширины: "pločio",
    длина: "ilgis",
    длину: "ilgį",
    длины: "ilgio",
    толщина: "storis",
    толщину: "storį",
    толщины: "storio",
    объем: "tūris",
    объема: "tūrio",
    площадь: "plotas",
    площади: "ploto",
    вес: "svoris",
    веса: "svorio",
    масса: "masė",
    массы: "masės",
    плотность: "tankis",
    плотности: "tankio",

    // Финансовые термины
    деньги: "pinigai",
    цена: "kaina",
    цены: "kainos",
    стоимость: "kaina",
    стоимости: "kainos",
    затраты: "išlaidos",
    расходы: "išlaidos",
    расход: "sąnaudos",
    экономия: "taupymas",
    экономии: "taupymo",
    экономить: "taupyti",
    сэкономить: "sutaupyti",
    выгода: "nauda",
    выгоды: "naudos",
    выгодно: "naudinga",
    прибыль: "pelnas",
    убыток: "nuostolis",
    доход: "pajamos",
    доходы: "pajamos",
    бюджет: "biudžetas",
    бюджета: "biudžeto",
    кредит: "kreditas",
    кредита: "kredito",
    займ: "paskola",
    заем: "paskola",
    ссуда: "paskola",
    процент: "procentas",
    проценты: "procentai",
    процентов: "procentų",
    скидка: "nuolaida",
    скидки: "nuolaidos",
    скидок: "nuolaidų",
    наценка: "antkainis",
    переплата: "permoka",
    переплатить: "permokėti",
    недоплата: "neprimoka",
    доплата: "papildomas mokestis",
    оплата: "mokestis",
    оплатить: "sumokėti",
    платить: "mokėti",
    заплатить: "sumokėti",
    покупка: "pirkimas",
    покупать: "pirkti",
    купить: "nupirkti",
    продажа: "pardavimas",
    продавать: "parduoti",
    продать: "parduoti",
    торговля: "prekyba",
    рынок: "rinka",
    рынка: "rinkos",
    спрос: "paklausa",
    предложение: "pasiūla",
    конкуренция: "konkurencija",
    конкурент: "konkurentas",
    конкуренты: "konkurentai",
    конкурентов: "konkurentų",

    // Специфические русские конструкции
    имеет: "turi",
    имеют: "turi",
    имею: "turiu",
    имеешь: "turi",
    имела: "turėjo",
    имели: "turėjo",
    "будет иметь": "turės",
    "будут иметь": "turės",
    обеспечивает: "užtikrina",
    обеспечивают: "užtikrina",
    обеспечить: "užtikrinti",
    предоставляет: "teikia",
    предоставляют: "teikia",
    предоставить: "suteikti",
    используется: "naudojamas",
    используют: "naudoja",
    использовать: "naudoti",
    применяется: "taikomas",
    применяют: "taiko",
    применить: "pritaikyti",
    создание: "kūrimas",
    создания: "kūrimo",
    создать: "sukurti",
    создают: "kuria",
    получение: "gavimas",
    получения: "gavimo",
    получить: "gauti",
    получают: "gauna",
    принимать: "priimti",
    принимают: "priima",
    принять: "priimti",
    отличный: "puikus",
    отличная: "puiki",
    отличные: "puikūs",
    превосходный: "puikus",
    замечательный: "nuostabus",
    прекрасный: "puikus",
    великолепный: "puikus",
    удивительный: "nuostabus",
    потрясающий: "nuostabus",
    фантастический: "fantastiškas",

    // Заменяем смешанные слова
    между: "tarp",
    против: "prieš",
    сравнению: "palyginimui",
    специальные: "specialūs",
    перегородок: "pertvarų",
    внутренних: "vidinių",
    обычными: "įprastais",
    модифицированную: "modifikuotą",
    улучшенными: "pagerėjusiais",
    характеристиками: "charakteristikomis",
    "по сравнению с": "palyginti su",
    blokasами: "blokais",
    blokasов: "blokų",
    blokasы: "blokai",
    под: "po",
    для: "skirta",
    из: "iš",
    на: "ant",
    в: "į",
    от: "nuo",
    до: "iki",
    при: "esant",
    после: "po",
    перед: "prieš",
    над: "virš",
    под: "po",
    внутри: "viduje",
    снаружи: "lauke",
    около: "šalia",
    возле: "prie",
    "рядом с": "šalia",
    "вместе с": "kartu su",
    без: "be",
    кроме: "išskyrus",
    "несмотря на": "nepaisant",
    благодаря: "dėka",
    "из-за": "dėl",
    вследствие: "dėl",
    "в результате": "dėl to",
    "в связи с": "dėl",
    относительно: "dėl",
    касательно: "dėl",
    regarding: "dėl",
    concerning: "dėl",
    about: "apie",
    "что касается": "kas liečia",
    "по поводу": "dėl",
    "в отношении": "dėl",

    // Глаголы
    быть: "būti",
    есть: "yra",
    был: "buvo",
    была: "buvo",
    были: "buvo",
    будет: "bus",
    будут: "bus",
    стать: "tapti",
    стал: "tapo",
    стала: "tapo",
    стали: "tapo",
    станет: "taps",
    станут: "taps",
    делать: "daryti",
    делаю: "darau",
    делает: "daro",
    делают: "daro",
    сделать: "padaryti",
    сделал: "padarė",
    сделала: "padarė",
    сделали: "padarė",
    работать: "dirbti",
    работаю: "dirbu",
    работает: "dirba",
    работают: "dirba",
    жить: "gyventi",
    живу: "gyvenu",
    живет: "gyvena",
    живут: "gyvena",
    идти: "eiti",
    иду: "einu",
    идет: "eina",
    идут: "eina",
    ехать: "važiuoti",
    езжу: "važiuoju",
    едет: "važiuoja",
    едут: "važiuoja",
    лететь: "skristi",
    лечу: "skrendu",
    летит: "skrenda",
    летят: "skrenda",
    плыть: "plaukti",
    плыву: "plaukiu",
    плывет: "plaukia",
    плывут: "plaukia",
    бежать: "bėgti",
    бегу: "bėgu",
    бежит: "bėga",
    бегут: "bėga",
    ходить: "vaikščioti",
    хожу: "vaikštau",
    ходит: "vaikšto",
    ходят: "vaikšto",
  };

  // Применяем все замены
  for (const [rus, lit] of Object.entries(replacements)) {
    const regex = new RegExp(rus.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "gi");
    result = result.replace(regex, lit);
  }

  // Дополнительная очистка смешанных конструкций
  result = result.replace(/([а-яёА-ЯЁ]+)/g, (match) => {
    // Заменяем оставшиеся русские слова на их литовские эквиваленты
    const word = match.toLowerCase();
    const commonWords = {
      этот: "šis",
      эта: "ši",
      это: "tai",
      эти: "šie",
      тот: "tas",
      та: "ta",
      то: "tai",
      те: "tie",
      мой: "mano",
      моя: "mano",
      мое: "mano",
      мои: "mano",
      твой: "tavo",
      твоя: "tavo",
      твое: "tavo",
      твои: "tavo",
      его: "jo",
      ее: "jos",
      их: "jų",
      наш: "mūsų",
      ваш: "jūsų",
      себя: "save",
      себе: "sau",
      собой: "savimi",
      один: "vienas",
      одна: "viena",
      одно: "viena",
      первый: "pirmas",
      второй: "antras",
      третий: "trečias",
      последний: "paskutinis",
      следующий: "kitas",
      новый: "naujas",
      старый: "senas",
      молодой: "jaunas",
      большой: "didelis",
      маленький: "mažas",
      средний: "vidutinis",
      хороший: "geras",
      плохой: "blogas",
      лучший: "geriausias",
      белый: "baltas",
      черный: "juodas",
      красный: "raudonas",
      синий: "mėlynas",
      зеленый: "žalias",
      желтый: "geltonas",
      право: "teisė",
      левый: "kairės",
      правый: "dešinės",
      верх: "viršus",
      низ: "apačia",
      середина: "vidurys",
      начало: "pradžia",
      конец: "pabaiga",
      центр: "centras",
    };

    return commonWords[word] || match; // Если нет перевода, оставляем как есть
  });

  return result;
}

async function finalTranslation() {
  try {
    console.log("🎯 ЗАВЕРШАЮЩИЙ ПОЛНЫЙ ПЕРЕВОД");
    console.log("=============================");

    const workbook = new ExcelJS.Workbook();
    await workbook.xlsx.readFile("HAUS_FAQ_COMPLETE_LITHUANIAN.xlsx");

    const lithuanianSheet = workbook.worksheets.find((ws) =>
      ws.name.includes("Lietuvių")
    );

    if (!lithuanianSheet) {
      console.log("❌ Литовская вкладка не найдена!");
      return;
    }

    console.log(`📋 Завершаем перевод листа: "${lithuanianSheet.name}"`);

    let translatedCount = 0;
    let totalRussianCells = 0;

    // Находим и переводим все оставшиеся русские ячейки
    for (let row = 2; row <= lithuanianSheet.rowCount; row++) {
      for (let col = 1; col <= lithuanianSheet.columnCount; col++) {
        const cell = lithuanianSheet.getCell(row, col);
        const originalValue = cell.value ? String(cell.value) : "";

        if (originalValue.length > 0 && /[а-яё]/i.test(originalValue)) {
          totalRussianCells++;
          const translatedValue = translateRemaining(originalValue);

          // Только обновляем если перевод изменился
          if (translatedValue !== originalValue) {
            cell.value = translatedValue;
            translatedCount++;

            if (translatedCount % 25 === 0) {
              console.log(`✅ Доперевожено ${translatedCount} ячеек...`);
            }
          }
        }
      }
    }

    // Сохраняем финальную версию
    await workbook.xlsx.writeFile("HAUS_FAQ_COMPLETE_LITHUANIAN.xlsx");

    console.log("\n🎉 ФИНАЛЬНЫЙ ПЕРЕВОД ЗАВЕРШЕН!");
    console.log("===============================");
    console.log(`📊 Найдено русских ячеек: ${totalRussianCells}`);
    console.log(`✅ Доперевожено: ${translatedCount}`);
    console.log(`📁 Файл обновлен: HAUS_FAQ_COMPLETE_LITHUANIAN.xlsx`);
    console.log("\n🇱🇹 Файл готов - весь контент на литовском языке!");
  } catch (error) {
    console.error("❌ Ошибка:", error.message);
  }
}

finalTranslation();
